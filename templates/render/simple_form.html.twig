{% extends 'component/view/base.html.twig' %}

{% block css %}
{% endblock %}

{% block javascripts %}
    <script>
        $(document).ready(function(){
            $("*[data-prototype]").click(function(evt) {
                $(evt.target).closest(".row").before($(evt.target).data("prototype"));
            })
            $("*[data-remove]").click(function(evt) {
                $(evt.target).closest(".row").remove();
            })
        })
    </script>
{% endblock %}

{% block body %}
    <div class="row">
        <h5 class="col title">
            {{ title }}
        </h5>
    </div>
    <div class="row">
        <div class="col-md-8">
            {{ form_start(form) }}
            {% for row in form %}
                {% if row.vars.allow_add is defined and row.vars.allow_add %}
                    <div class="row">
                        {{ form_label(row) }}
                        <div class="col-sm-10 form-group">
                            {{ form_errors(form) }}
                            {% for c in row %}
                                <div class="row mb-1">
                                    <div class="col-sm-1 d-flex justify-content-center align-items-center text-danger btn-like">
                                        <i class="material-icons p-1" data-remove>clear</i>
                                    </div>
                                    <div class="col-sm-11">
                                        {{ form_widget(c) }}
                                    </div>
                                </div>
                            {% endfor %}
                            {% set prototype = "
                                <div class='row mb-1'>
                                    <div class='col-sm-1 d-flex justify-content-center align-items-center text-danger btn-like'>
                                        <i class='material-icons p-1'>clear</i>
                                    </div>
                                    <div class='col-sm-11''>" ~ form_widget(row.vars.prototype) ~ "</div>
                                </div>"
                            %}

                            <div class="row mt-2">
                                <div class="text-center col text-primary btn-like">
                                    <i class="material-icons p-1" data-prototype="{{ prototype }}">add</i>
                                </div>
                            </div>
                        </div>
                    </div>
                {% else %}
                    {{ form_row(row) }}
                {% endif %}
            {% endfor %}
            {{ form_end(form) }}
        </div>
    </div>
{% endblock %}